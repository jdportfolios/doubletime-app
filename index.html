<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DoubleTime App</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Lucide icons as inline SVG components
    const Play = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="5 3 19 12 5 21 5 3"></polygon>
      </svg>
    );

    const Pause = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="6" y="4" width="4" height="16"></rect>
        <rect x="14" y="4" width="4" height="16"></rect>
      </svg>
    );

    const RotateCcw = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="1 4 1 10 7 10"></polyline>
        <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
      </svg>
    );

    const BellOff = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
        <path d="M18.63 13A17.89 17.89 0 0 1 18 8"></path>
        <path d="M6.26 6.26A5.86 5.86 0 0 0 6 8c0 7-3 9-3 9h14"></path>
        <path d="M18 8a6 6 0 0 0-9.33-5"></path>
        <line x1="1" y1="1" x2="23" y2="23"></line>
      </svg>
    );

    const ChevronDown = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    );

    // Sound Utility
    const playAlarmSound = (pitch = 440, type = 'square') => {
      const AudioContext = window.AudioContext || window.webkitAudioContext;
      if (!AudioContext) return;

      const ctx = new AudioContext();
      const osc = ctx.createOscillator();
      const gainNode = ctx.createGain();

      osc.type = type;
      osc.frequency.setValueAtTime(pitch, ctx.currentTime);
      
      gainNode.gain.setValueAtTime(0.1, ctx.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.5);

      osc.connect(gainNode);
      gainNode.connect(ctx.destination);

      osc.start();
      osc.stop(ctx.currentTime + 0.5);

      setTimeout(() => {
        if(ctx.state !== 'closed') ctx.close();
      }, 600);
    };

    // Default SVG Characters
    const RobotCharacter = ({ state }) => {
      const isAlarm = state === 'alarm';
      const isRunning = state === 'running';
      return (
        <svg viewBox="0 0 200 200" className={`w-full h-full transition-transform duration-300 ${isAlarm ? 'animate-bounce' : ''}`}>
          <defs>
            <style>
              {`
                @keyframes whisk {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(10deg); }
                }
                .animate-whisk {
                  animation: whisk 0.5s infinite alternate ease-in-out;
                  transform-origin: 50px 60px;
                }
              `}
            </style>
          </defs>
          <line x1="100" y1="60" x2="100" y2="30" stroke="#475569" strokeWidth="4" />
          <circle cx="100" cy="25" r="5" fill="#ef4444" className={isRunning ? 'animate-pulse' : ''} />
          
          <g className={isRunning ? 'animate-whisk' : ''}>
            <rect x="50" y="60" width="100" height="90" rx="10" fill="#cbd5e1" stroke="#475569" strokeWidth="4" />
            <rect x="60" y="80" width="80" height="30" rx="5" fill="#1e293b" />
          </g>

          {state === 'idle' && (
            <>
              <circle cx="80" cy="95" r="5" fill="#3b82f6" />
              <circle cx="120" cy="95" r="5" fill="#3b82f6" />
            </>
          )}
          {isRunning && (
            <>
              <rect x="75" y="92" width="10" height="6" fill="#22c55e" />
              <rect x="115" y="92" width="10" height="6" fill="#22c55e" />
            </>
          )}
          {isAlarm && (
            <>
              <text x="73" y="102" fontSize="20" fill="#ef4444" fontWeight="bold">X</text>
              <text x="113" y="102" fontSize="20" fill="#ef4444" fontWeight="bold">X</text>
            </>
          )}
          {state === 'idle' && <line x1="80" y1="130" x2="120" y2="130" stroke="#475569" strokeWidth="3" />}
          {isRunning && <path d="M 80 130 Q 100 140 120 130" fill="none" stroke="#475569" strokeWidth="3" />}
          {isAlarm && <rect x="85" y="125" width="30" height="10" rx="2" fill="#ef4444" className="animate-pulse" />}
        </svg>
      );
    };

    const AlienCharacter = ({ state }) => {
      const isAlarm = state === 'alarm';
      const isRunning = state === 'running';
      return (
        <svg viewBox="0 0 200 200" className={`w-full h-full transition-transform duration-300 ${isAlarm ? 'animate-spin-slow' : ''}`}>
          <defs>
            <style>
              {`
                .animate-spin-slow { animation: spin 0.5s linear infinite alternate; } 
                @keyframes spin { from { transform: rotate(-10deg); } to { transform: rotate(10deg); } }
                
                @keyframes stir {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(15deg); }
                }
                .animate-stir {
                  animation: stir 0.8s infinite alternate ease-in-out;
                  transform-origin: 100px 150px;
                }
              `}
            </style>
          </defs>
          
          <g className={isRunning ? 'animate-stir' : ''}>
            <path d="M 50 150 Q 100 20 150 150 Q 100 170 50 150" fill="#86efac" stroke="#166534" strokeWidth="4" />
          </g>

          <circle cx="70" cy="100" r="5" fill="#4ade80" />
          <circle cx="130" cy="80" r="8" fill="#4ade80" />
          <circle cx="100" cy="90" r="25" fill="white" stroke="#166534" strokeWidth="3" />
          {state === 'idle' && <circle cx="100" cy="90" r="8" fill="#166534" />}
          {isRunning && <circle cx="100" cy="90" r="5" fill="#166534" className="animate-ping" />}
          {isAlarm && (
            <>
              <circle cx="95" cy="85" r="3" fill="#ef4444" />
              <circle cx="105" cy="95" r="5" fill="#ef4444" />
            </>
          )}
          {state === 'idle' && <path d="M 90 130 Q 100 135 110 130" fill="none" stroke="#166534" strokeWidth="3" />}
          {isRunning && <circle cx="100" cy="130" r="5" fill="#166534" />}
          {isAlarm && <ellipse cx="100" cy="130" rx="10" ry="15" fill="#166534" />}
        </svg>
      );
    };

    // Timer Component
    const TimerColumn = ({ 
      title, 
      CharacterComponent, 
      customImage = null,
      initialMinutes = 5, 
      colorTheme = "blue",
      pitch = 440
    }) => {
      const [timeLeft, setTimeLeft] = useState(initialMinutes * 60);
      const [isActive, setIsActive] = useState(false);
      const [isAlarming, setIsAlarming] = useState(false);
      const [setupMode, setSetupMode] = useState(true);
      
      const [headerTitle, setHeaderTitle] = useState(title);

      const [inputMinutes, setInputMinutes] = useState(initialMinutes);
      const [inputSeconds, setInputSeconds] = useState(0);
      
      const [imgError, setImgError] = useState(false);

      const timerRef = useRef(null);
      const alarmIntervalRef = useRef(null);

      useEffect(() => {
        if (setupMode) {
          setTimeLeft(inputMinutes * 60 + inputSeconds);
        }
      }, [inputMinutes, inputSeconds, setupMode]);

      let charState = 'idle';
      if (isAlarming) charState = 'alarm';
      else if (isActive) charState = 'running';

      const formatTime = (seconds) => {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      };

      const toggleTimer = () => {
        if (isAlarming) {
          stopAlarm();
          return;
        }
        if (setupMode) {
          setSetupMode(false);
          setTimeLeft(inputMinutes * 60 + inputSeconds);
        }
        setIsActive(!isActive);
      };

      const resetTimer = () => {
        setIsActive(false);
        setIsAlarming(false);
        setSetupMode(true);
        if (timerRef.current) clearInterval(timerRef.current);
        if (alarmIntervalRef.current) clearInterval(alarmIntervalRef.current);
        
        setInputMinutes(0);
        setInputSeconds(0);
        setTimeLeft(0);
      };

      const stopAlarm = () => {
        setIsAlarming(false);
        setIsActive(false);
        setSetupMode(true);
        if (alarmIntervalRef.current) clearInterval(alarmIntervalRef.current);
      };

      const applyPreset = (minutesToAdd, secondsToAdd) => {
        let newSeconds = inputSeconds + secondsToAdd;
        let newMinutes = inputMinutes + minutesToAdd;

        if (newSeconds >= 60) {
          newMinutes += Math.floor(newSeconds / 60);
          newSeconds = newSeconds % 60;
        }

        if (newMinutes > 99) newMinutes = 99;

        setInputMinutes(newMinutes);
        setInputSeconds(newSeconds);
      };

      useEffect(() => {
        if (isActive && timeLeft > 0) {
          timerRef.current = setInterval(() => {
            setTimeLeft((prev) => prev - 1);
          }, 1000);
        } else if (timeLeft === 0 && isActive) {
          setIsActive(false);
          setIsAlarming(true);
          clearInterval(timerRef.current);
          playAlarmSound(pitch, 'sawtooth');
          alarmIntervalRef.current = setInterval(() => {
            playAlarmSound(pitch, 'sawtooth');
          }, 800);
        }
        return () => clearInterval(timerRef.current);
      }, [isActive, timeLeft, pitch]);

      useEffect(() => {
        return () => {
          if (alarmIntervalRef.current) clearInterval(alarmIntervalRef.current);
        };
      }, []);

      const bgClass = colorTheme === 'blue' ? 'bg-[#f4c8c8]' : 'bg-[#c8e6c9]';
      const borderClass = colorTheme === 'blue' ? 'border-[#f4c8c8]' : 'border-[#c8e6c9]';
      const btnClass = colorTheme === 'blue' 
        ? 'bg-[#a67c52] hover:bg-[#8d6a45] text-white' 
        : 'bg-[#4a7c59] hover:bg-[#3d6647] text-white';
      const activeRing = isAlarming ? 'ring-8 ring-red-400 ring-opacity-50' : '';

      return (
        <div className={`flex-1 p-6 flex flex-col items-center justify-center transition-all duration-300 ${bgClass} border-x ${borderClass} ${activeRing} relative`}>
          {setupMode ? (
            <input 
              type="text" 
              value={headerTitle}
              onChange={(e) => setHeaderTitle(e.target.value)}
              className="text-xl font-bold mb-8 text-gray-600 uppercase tracking-widest text-center bg-transparent border-b-2 border-transparent hover:border-gray-400 focus:border-blue-500 focus:outline-none transition-all w-full max-w-xs"
            />
          ) : (
            <h2 className="text-xl font-bold mb-8 text-gray-600 uppercase tracking-widest">{headerTitle}</h2>
          )}

          <div className="mb-8 bg-white rounded-full shadow-xl border-4 border-white overflow-hidden w-52 h-52 flex items-center justify-center relative">
            {customImage && !imgError ? (
              <img 
                src={customImage} 
                alt="Character" 
                onError={() => setImgError(true)}
                className={`w-full h-full object-cover transition-transform duration-300 ${isAlarming ? 'animate-bounce' : ''}`} 
              />
            ) : (
              <CharacterComponent state={charState} />
            )}
          </div>

          <div className="text-7xl font-bold text-gray-800 mb-8 tabular-nums tracking-tight" style={{ color: '#2c3e50' }}>
            {formatTime(timeLeft)}
          </div>

          {setupMode && (
            <div className="flex flex-col items-center gap-4 mb-8">
              <div className="flex gap-3">
                <button onClick={() => applyPreset(0, 30)} className="px-6 py-3 text-lg font-bold text-gray-700 bg-white hover:bg-gray-50 rounded-2xl transition-all shadow-sm">+30s</button>
                <button onClick={() => applyPreset(1, 0)} className="px-6 py-3 text-lg font-bold text-gray-700 bg-white hover:bg-gray-50 rounded-2xl transition-all shadow-sm">+1m</button>
                <button onClick={() => applyPreset(5, 0)} className="px-6 py-3 text-lg font-bold text-gray-700 bg-white hover:bg-gray-50 rounded-2xl transition-all shadow-sm">+5m</button>
                <button onClick={() => applyPreset(30, 0)} className="px-6 py-3 text-lg font-bold text-gray-700 bg-white hover:bg-gray-50 rounded-2xl transition-all shadow-sm">+30m</button>
              </div>

              <div className="w-64 h-px bg-gray-400/30 my-2"></div>

              <div className="flex items-center justify-center gap-2">
                <div className="flex flex-col items-center">
                  <label className="text-xs font-bold text-gray-500 uppercase mb-1">Minutes</label>
                  <div className="relative">
                    <select 
                      value={inputMinutes}
                      onChange={(e) => setInputMinutes(Number(e.target.value))}
                      className="block w-24 p-2 pl-4 pr-10 text-lg font-bold text-gray-700 bg-white border border-gray-200 rounded-xl focus:border-blue-400 focus:ring-2 focus:ring-blue-100 focus:outline-none shadow-sm cursor-pointer hover:border-gray-300 appearance-none transition-all"
                    >
                      {Array.from({length: 100}, (_, i) => (
                        <option key={i} value={i}>{i}</option>
                      ))}
                    </select>
                    <ChevronDown className="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" />
                  </div>
                </div>
                <span className="text-xl font-bold text-gray-300 mt-6">:</span>
                <div className="flex flex-col items-center">
                  <label className="text-xs font-bold text-gray-500 uppercase mb-1">Seconds</label>
                  <div className="relative">
                    <select 
                      value={inputSeconds}
                      onChange={(e) => setInputSeconds(Number(e.target.value))}
                      className="block w-24 p-2 pl-4 pr-10 text-lg font-bold text-gray-700 bg-white border border-gray-200 rounded-xl focus:border-blue-400 focus:ring-2 focus:ring-blue-100 focus:outline-none shadow-sm cursor-pointer hover:border-gray-300 appearance-none transition-all"
                    >
                      {Array.from({length: 60}, (_, i) => (
                         <option key={i} value={i}>{i < 10 ? `0${i}` : i}</option>
                      ))}
                    </select>
                    <ChevronDown className="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none" />
                  </div>
                </div>
              </div>
            </div>
          )}

          <div className="flex gap-4">
            {isAlarming ? (
               <button onClick={stopAlarm} className="px-8 py-4 bg-red-500 hover:bg-red-600 text-white rounded-xl shadow-lg flex items-center gap-2 text-xl font-bold animate-pulse">
                 <BellOff size={24} /> Stop Alarm
               </button>
            ) : (
              <>
                <button onClick={toggleTimer} className={`px-8 py-4 rounded-xl shadow-lg flex items-center gap-2 text-xl font-bold tracking-wider transition-transform active:scale-95 ${btnClass}`}>
                  {isActive ? <><Pause size={24} /> Pause</> : <><Play size={24} /> Start</>}
                </button>
                <button onClick={resetTimer} className="px-6 py-4 bg-white hover:bg-gray-50 text-gray-600 rounded-xl shadow-sm flex items-center justify-center gap-2 font-bold text-lg tracking-wider transition-colors">
                  Reset <RotateCcw size={24} />
                </button>
              </>
            )}
          </div>
        </div>
      );
    };

    // Main App
    function App() {
      return (
        <div 
          className="flex flex-col md:flex-row h-screen w-full bg-white text-slate-800"
          style={{ fontFamily: "'Roboto', sans-serif" }}
        >
          <TimerColumn 
            title="TIMER 1" 
            CharacterComponent={RobotCharacter} 
            customImage="./dee.jpg" 
            initialMinutes={0}
            colorTheme="blue"
            pitch={300}
          />

          <TimerColumn 
            title="TIMER 2" 
            CharacterComponent={AlienCharacter} 
            customImage="./tot.jpg"
            initialMinutes={0}
            colorTheme="green"
            pitch={600}
          />
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>